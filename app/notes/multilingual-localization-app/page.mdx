import { EntryBanner } from "@/app/notes/components/entry-banner";
import { multiLinguqalLocalizationApp } from "@/app/notes/state/entries";

<EntryBanner entryItem={multiLinguqalLocalizationApp} />

## Step 1: Install i18next dependencies

Lets first install the dependencies:

\
`npm i i18next, i18next-browser-languagedetector, i18next-chained-backend i18next-resources-to-backend`

\
Here's what each of these dependencies does:
**i18next**: It provides the core functionality for managing translations and handling different languages in your application.

\
**i18next-browser-languagedetector**: Automatically detects the user's language preference by checking browser settings, cookies, and query parameters.

\
**i18next-chained-backend**: Enables chaining of multiple backends and caches for loading translation resources, prioritizing local cache before remote fetching.

\
**i18next-resources-to-backend**: Transforms resources for lazy loading in i18next, allowing dynamic loading of translations to reduce initial application load time.

Once our dependencies have been installed, lets go ahead and create instance of i18next
\notes

## Step 2: Create an instance of `react-i18next`

We can use [createInstance](https://github.com/learnuidev/myelin.dev/blob/main/libs/i18n-next/init.ts) function to create an instance. Next lets define `i18nOptions`. You can find the full code [here](https://github.com/learnuidev/myelin.dev/blob/main/libs/i18n-next/i18n-config.ts).

## Step 3: Creat `i18next-provider`

Full implementation can be found [here](https://github.com/learnuidev/myelin.dev/blob/71d599f22c0a21f84ce7a985edbe69e42e3262f6/libs/i18n-next/i18n-next-provider.tsx)

\
...

```
"use client";

import React, { ReactNode, useEffect } from "react";
import { I18nextProvider } from "react-i18next";

import i18nInstance from "./init";
import { i18nConfig } from "./i18n-config";
import { getCookie } from "./cookie-utils";

export function I18NextProvider({ children }: { children: ReactNode }) {
  const locale = getCookie(i18nConfig.cookieName);

  useEffect(() => {
    if (i18nInstance.isInitialized) {
      i18nInstance.changeLanguage(locale);
    }
  }, [locale]);
  return <I18nextProvider i18n={i18nInstance}>{children}</I18nextProvider>;
}


```

## Step 4: Implement cookie utilities

```
export function setCookie(key: string, value: string) {
  if (isClientSide()) {
    document.cookie = `${encodeURIComponent(key)}=${encodeURIComponent(value)}; Secure; SameSite=Lax; path=/`;
  }
}

export function getCookie(key: string) {
  if (isClientSide()) {
    const cookies = document.cookie ? document.cookie.split("; ") : [];
    for (let i = 0; i < cookies.length; i++) {
      const parts = cookies[i].split("=");
      const cookieKey = decodeURIComponent(parts[0]);

      if (cookieKey === key) {
        const cookieValue = parts.slice(1).join("=");
        return decodeURIComponent(cookieValue);
      }
    }
  }
}

export function removeCookie(key: string) {
  if (isClientSide()) {
    document.cookie = `${encodeURIComponent(key)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; Secure; SameSite=Lax; path=/`;
  }
}

export const isClientSide = () => typeof window !== "undefined";


```

## Step 5: Implement middleware

```
import { cookies } from "next/headers";
import { NextRequest, NextResponse } from "next/server";
import { i18nConfig } from "./libs/i18n-next/i18n-config";

export async function middleware(request: NextRequest) {
  const current = (await cookies()).get(i18nConfig.cookieName)?.value;
  const response = NextResponse.next();

  if (!current) {
    response.cookies.set(i18nConfig.cookieName, i18nConfig.fallbackLanguage);
  }

  // Store current request url in a custom header, so we can read them later
  response.headers.set("x-url", request.url);

  return response;
}

```

## Step 6: Wrap the RootLayout component with provider

```
import { i18nConfig } from "@/libs/i18n-next/i18n-config";
import { I18NextProvider } from "@/libs/i18n-next/i18n-next-provider";


export default async function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const locale = (await cookies()).get(i18nConfig.cookieName)?.value;
  const direction = dir(locale);

  return (
    <I18NextProvider>
      <html suppressHydrationWarning lang={locale} dir={direction}>
       ...
      </html>
    </I18NextProvider>
  );
}

```

## Step 7: Impelement custom use-translate hook

```

import { Namespace } from "i18next";
import {
  useTranslation as useReactI18nTranslation,
  UseTranslationOptions,
} from "react-i18next";
import { _DefaultNamespace } from "react-i18next/TransWithoutContext";

function useCustomTranslation<Ns extends Namespace = _DefaultNamespace>(
  namespace: Ns,
  options?: UseTranslationOptions<undefined>
) {
  const translationResult = useReactI18nTranslation(namespace, options);

  return {
    ...translationResult,
  };
}

export { useCustomTranslation as useTranslation };


```

## Step 8: Implement Language Switcher

```
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";

import { Button } from "@/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

import { useTranslation } from "./use-translation";
import { getCookie, setCookie } from "./cookie-utils";
import { i18nConfig, Language, languagesList } from "./i18n-config";

export function LanguageSwitcher() {
  const locale = getCookie(i18nConfig.cookieName) as Language;
  const [selectedItem, setSelectedItem] = useState<Language>(
    locale || i18nConfig.fallbackLanguage
  );
  const router = useRouter();
  const { i18n } = useTranslation("common");
  const handleChange = async (value: Language) => {
    const newLocale = value;
    setSelectedItem(newLocale);
    // set cookie for next-i18n-router
    await i18n.changeLanguage(newLocale, () => {
      setCookie(i18nConfig.cookieName, newLocale);
    });

    router.refresh();
  };

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" className="rounded-full">
          <div className="">{languagesList[selectedItem].language}</div>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent className="w-fit">
        {i18nConfig.languages.map((item) => {
          return (
            <DropdownMenuItem
              key={item}
              className="flex items-center gap-2"
              onClick={() => handleChange(item)}
            >
              <p>{languagesList[item].language}</p>
            </DropdownMenuItem>
          );
        })}
      </DropdownMenuContent>
    </DropdownMenu>
  );
}


```

## Step 9: Create locales

`locales/en/common.json`

```
{
    "title": "Welcome to the app"
}
```

## Step 10: Create `myelin.config.json`

Next we are going to create `myelin.config.json`

```
{
    "aiProvider": "deepseek",
    "aiModel": "deepseek-chat",
    "locale": {
        "location": "locales",
        "sourceLanguage": "en",
        "targetLanguages": [
            "es",
            "fr",
            "zh",
            "zh-TW",
            "en-US"
        ]
    }
}

```

## Step 11: Run Translate

```
> npx myelino --translate

```

## Step 12: Use translation

```
import { useTranslation } from "@/libs/i18n-next/use-translation";

const { t } = useTranslation(["common"]);

...
t("title")

```
